webpackJsonp([2],{"6ULT":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s(a("j3zY")),i=s(a("D+Dq"));function s(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}t.default={data(){return{tableData:[],pagination:{totalCount:0,page:1,pageSize:5,sortBy:"",sort:""},searchValue:"",loading:!0,dialogFormVisible:!1,dialogStatus:"",form:{name:"",allows:[]},resourceOptions:[],operationOptions:[{value:"show",label:"查看"},{value:"operate",label:"操作"}],rules:{name:[{required:!0,message:this.$t("validation.require")+this.$t("common.space")+this.$t("role.name")},{min:3,max:12,message:"3-12"+this.$t("validation.characters")}]},formLabelWidth:"120px"}},created(){this.initTable()},methods:{initTable(e){this.loading=!0,e&&(this.pagination.page=1);const t={page:this.pagination.page,pageSize:this.pagination.pageSize,filter:this.searchValue,sortBy:this.pagination.sortBy,sort:this.pagination.sort};this.$doRequest(o.getRoleList(t),"获取角色列表",this.$showErrorType.none).then(e=>{setTimeout(()=>{this.loading=!1},200),this.tableData=e.result,this.pagination.totalCount=e.totalCount},e=>{e&&console.log(e),setTimeout(()=>{this.loading=!1},200)})},handleSizeChange(e){this.pagination.pageSize=e,this.initTable()},handleCurrentChange(e){this.pagination.page=e,this.initTable()},handleSortChange(e){this.pagination.sortBy=e.prop,e.order?this.pagination.sort="ascending"===e.order?"asc":"desc":this.pagination.sort=null,this.initTable()},resetForm(){this.form={name:"",allows:[]}},removeResource(e){var t=this.form.allows.indexOf(e);-1!==t&&this.form.allows.splice(t,1)},addResource(){this.form.allows.push({resources:"",permissions:[],key:this.$uuid()})},handleCreate(){this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(()=>{this.$refs.dataForm.clearValidate()}),this.$doRequest(i.getResourceAll(),"获取资源列表",this.$showErrorType.none).then(e=>{this.resourceOptions=[],e.result.forEach(e=>{this.resourceOptions.push({value:e.id,label:e.name})})})},createRole(){this.$refs.dataForm.validate(e=>{if(e){const e={name:this.form.name,allows:this.form.allows};this.$doRequest(o.addRole(e),"增加角色").then(()=>{this.initTable(),this.dialogFormVisible=!1})}})},handleEdit(e){this.$doRequest(o.getRole(e),"获取指定角色",this.$showErrorType.none).then(e=>{let t=[];for(let a in e.allows)t.push({resources:a,permissions:e.allows[a],key:this.$uuid()});e.allows=t,this.form=e||{},this.dialogStatus="edit",this.dialogFormVisible=!0,this.$nextTick(()=>{this.$refs.dataForm.clearValidate()}),this.$doRequest(i.getResourceAll(),"获取资源列表",this.$showErrorType.none).then(e=>{this.resourceOptions=[],e.result.forEach(e=>{this.resourceOptions.push({value:e.id,label:e.name})})})})},editRole(){console.log("click"),this.$refs.dataForm.validate(e=>{if(console.log("valid"),e){const e={name:this.form.name,allows:this.form.allows};this.$doRequest(o.editRole(this.form.id,e),"编辑角色").then(()=>{this.initTable(),this.dialogFormVisible=!1})}})},handleDelete(e,t){console.log("delete",e,t),o.deleteRole(e).then(()=>{this.initTable()})}}}},"9zTd":function(e,t,a){"use strict";var o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v(e._s(e.$t("common.add")))]),e._v(" "),a("el-input",{model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"promary"},on:{click:e.initTable}},[e._v("搜索")])],1),e._v(" "),a("el-dialog",{attrs:{title:e.$t("common.add")+e.$t("common.space")+e.$t("role.role"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",staticClass:"demo-dynamic",attrs:{rules:e.rules,model:e.form,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:e.$t("role.name"),prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),e._l(e.form.allows,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:"资源"+o}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"allows."+o+".resources",rules:{required:!0,message:"资源不能为空",trigger:"blur"}}},[a("el-select",{attrs:{placeholder:"选择资源"},model:{value:t.resources,callback:function(a){e.$set(t,"resources",a)},expression:"resource.resources"}},e._l(e.resourceOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:1}},[e._v("\n          -\n        ")]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"allows."+o+".permissions",rules:{required:!0,message:"操作不能为空",trigger:"blur"}}},[a("el-select",{attrs:{multiple:"",placeholder:"选择权限"},model:{value:t.permissions,callback:function(a){e.$set(t,"permissions",a)},expression:"resource.permissions"}},e._l(e.operationOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:3}},[e._v("\n          -\n        ")]),e._v(" "),a("el-col",{attrs:{span:4}},[a("el-form-item",[a("el-button",{staticStyle:{float:"right"},on:{click:function(a){a.preventDefault(),e.removeResource(t)}}},[e._v("删除")])],1)],1)],1)}),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.addResource}},[e._v("新增资源")])],1)],2),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),"create"===e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.createRole}},[e._v(e._s(e.$t("common.confirm")))]):e._e(),e._v(" "),"edit"===e.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.editRole}},[e._v(e._s(e.$t("common.confirm")))]):e._e()],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.handleSortChange}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:e.$t("role.name"),sortable:"custom",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:e.$t("common.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.handleEdit(t.row.id)}}},[e._v(e._s(e.$t("common.edit")))]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.row.id)}}},[e._v(e._s(e.$t("common.delete")))])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-sizes":[2,5,10,20],"page-size":e.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};t.a=o},"D+Dq":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResource=t.editResource=t.deleteResource=t.addResource=t.getResourceAll=t.getResourceList=void 0;var o,i=a("dTAI"),s=(o=i)&&o.__esModule?o:{default:o};t.getResourceList=(e=>s.default.get(`/acl_resource?page=${e.page}&pageSize=${e.pageSize}&filter=${e.filter}&sortBy=${e.sortBy}&sort=${e.sort}`)),t.getResourceAll=(()=>s.default.get("/acl_resource")),t.addResource=(e=>s.default.post("./acl_resource",e)),t.deleteResource=(e=>s.default.delete("./acl_resource/"+e)),t.editResource=((e,t)=>s.default.put("./acl_resource/"+e,t)),t.getResource=(e=>s.default.get("/acl_resource/"+e))},V8iA:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("6ULT"),i=a.n(o);for(var s in o)"default"!==s&&function(e){a.d(t,e,function(){return o[e]})}(s);var l=a("9zTd");var r=function(e){a("Z4FG")},n=a("vSla")(i.a,l.a,!1,r,null,null);t.default=n.exports},Z4FG:function(e,t){}});
//# sourceMappingURL=2.0a3fd0e034fb0d497475.js.map