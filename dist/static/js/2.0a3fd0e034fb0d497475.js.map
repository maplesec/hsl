{"version":3,"sources":["webpack:///src/components/role/role.vue","webpack:///./src/components/role/role.vue?3066","webpack:///./src/services/resource.js","webpack:///./src/components/role/role.vue"],"names":["api","__webpack_require__","api2","[object Object]","tableData","pagination","totalCount","page","pageSize","sortBy","sort","searchValue","loading","dialogFormVisible","dialogStatus","form","name","allows","resourceOptions","operationOptions","value","label","rules","required","message","this","$t","min","max","formLabelWidth","initTable","methods","isSearch","query","filter","$doRequest","getRoleList","$showErrorType","none","then","res","setTimeout","result","err","console","log","val","prop","order","item","index","indexOf","splice","push","resources","permissions","key","$uuid","resetForm","$nextTick","$refs","clearValidate","getResourceAll","forEach","id","validate","valid","params","addRole","getRole","allow","editRole","row","deleteRole","esExports","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","type","icon","on","click","handleCreate","_v","_s","model","callback","$$v","expression","title","visible","update:visible","$event","ref","label-position","label-width","auto-complete","$set","_l","resource","span","trigger","placeholder","multiple","staticStyle","float","preventDefault","removeResource","addResource","slot","createRole","_e","directives","rawName","width","data","sort-change","handleSortChange","sortable","scopedSlots","_u","fn","scope","size","handleEdit","handleDelete","current-page","page-sizes","page-size","layout","total","size-change","handleSizeChange","current-change","handleCurrentChange","staticRenderFns","__webpack_exports__","_axios","getResourceList","axios","get","post","deleteResource","delete","editResource","put","getResource","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_2_vue_loader_lib_template_compiler_index_id_data_v_3f39bc62_hasScoped_false_transformToRequire_video_src_poster_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_2_vue_loader_lib_selector_type_template_index_0_role_vue__","__vue_styles__","ssrContext","Component","normalizeComponent","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_2_vue_loader_lib_selector_type_script_index_0_role_vue___default","a"],"mappings":"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","file":"static/js/2.0a3fd0e034fb0d497475.js","sourcesContent":["<template>\r\n  <div class=\"app-container calendar-list-container\">\r\n    <div class=\"filter-container\">\r\n      <el-button class=\"filter-item\" @click=\"handleCreate\" type=\"primary\" icon=\"el-icon-edit\">{{$t('common.add')}}</el-button>\r\n      <el-input v-model=\"searchValue\"></el-input>\r\n      <el-button class=\"filter-item\" @click=\"initTable\" type=\"promary\">搜索</el-button>\r\n    </div>\r\n\r\n    <el-dialog :title=\"$t('common.add') + $t('common.space') + $t('role.role')\" :visible.sync=\"dialogFormVisible\">\r\n      <el-form :rules=\"rules\" ref=\"dataForm\" :model=\"form\" label-position=\"left\" label-width=\"120px\" class=\"demo-dynamic\">\r\n        <el-form-item :label=\"$t('role.name')\" prop=\"name\">\r\n          <el-input v-model=\"form.name\" auto-complete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item\r\n          v-for=\"(resource, index) in form.allows\"\r\n          :label=\"'资源' + index\"\r\n          :key=\"resource.key\"\r\n        >\r\n          <el-col :span=\"8\">\r\n            <el-form-item\r\n              :prop=\"'allows.' + index + '.resources'\"\r\n              :rules=\"{\r\n                required: true, message: '资源不能为空', trigger: 'blur'\r\n              }\">\r\n              <el-select v-model=\"resource.resources\" placeholder=\"选择资源\">\r\n                <el-option\r\n                  v-for=\"item in resourceOptions\"\r\n                  :key=\"item.value\"\r\n                  :label=\"item.label\"\r\n                  :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"1\">\r\n            -\r\n          </el-col>\r\n          <el-col :span=\"8\">\r\n            <el-form-item\r\n              :prop=\"'allows.' + index + '.permissions'\"\r\n              :rules=\"{\r\n                required: true, message: '操作不能为空', trigger: 'blur'\r\n              }\">\r\n              <el-select v-model=\"resource.permissions\" multiple  placeholder=\"选择权限\">\r\n                <el-option\r\n                  v-for=\"item in operationOptions\"\r\n                  :key=\"item.value\"\r\n                  :label=\"item.label\"\r\n                  :value=\"item.value\">\r\n                </el-option>\r\n              </el-select>\r\n            </el-form-item>\r\n          </el-col>\r\n          <el-col :span=\"3\">\r\n            -\r\n          </el-col>\r\n          <el-col :span=\"4\">\r\n            <el-form-item>\r\n              <el-button @click.prevent=\"removeResource(resource)\" style=\"float:right\">删除</el-button>\r\n            </el-form-item>\r\n          </el-col>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button @click=\"addResource\">新增资源</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogFormVisible = false\">{{$t('common.cancel')}}</el-button>\r\n        <el-button type=\"primary\" v-if=\"dialogStatus==='create'\" @click=\"createRole\">{{$t('common.confirm')}}</el-button>\r\n        <el-button type=\"primary\" v-if=\"dialogStatus==='edit'\" @click=\"editRole\">{{$t('common.confirm')}}</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"tableData\"\r\n      @sort-change=\"handleSortChange\"\r\n      style=\"width: 100%\">\r\n      <el-table-column\r\n        prop=\"id\"\r\n        label=\"ID\"\r\n        width=\"180\">\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"name\"\r\n        :label=\"$t('role.name')\"\r\n        sortable=\"custom\"\r\n        width=\"180\">\r\n      </el-table-column>\r\n      <el-table-column :label=\"$t('common.operation')\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"mini\" @click=\"handleEdit(scope.row.id)\">{{$t('common.edit')}}</el-button>\r\n          <el-button size=\"mini\" type=\"danger\" @click=\"handleDelete(scope.row.id)\">{{$t('common.delete')}}</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      @size-change=\"handleSizeChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"pagination.page\"\r\n      :page-sizes=\"[2, 5, 10, 20]\"\r\n      :page-size=\"pagination.pageSize\"\r\n      layout=\"total, sizes, prev, pager, next, jumper\"\r\n      :total=\"pagination.totalCount\">\r\n    </el-pagination>\r\n  </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nimport * as api from '@/services/role'\r\nimport * as api2 from '@/services/resource'\r\n// import * as api2 from '@/services/resource'\r\nexport default {\r\n  data () {\r\n    return {\r\n      tableData: [],\r\n      pagination: {\r\n        totalCount: 0,\r\n        page: 1,\r\n        pageSize: 5,\r\n        sortBy: '',\r\n        sort: ''\r\n      },\r\n      searchValue: '',\r\n      loading: true,\r\n      dialogFormVisible: false,\r\n      dialogStatus: '',\r\n      form: {\r\n        name: '',\r\n        allows: []\r\n      },\r\n      resourceOptions: [],\r\n      operationOptions: [{\r\n        value: 'show',\r\n        label: '查看'\r\n      }, {\r\n        value: 'operate',\r\n        label: '操作'\r\n      }],\r\n      rules: {\r\n        name: [\r\n          {required: true, message: this.$t('validation.require') + this.$t('common.space') + this.$t('role.name')},\r\n          {min: 3, max: 12, message: '3-12' + this.$t('validation.characters')}\r\n        ]\r\n      },\r\n      formLabelWidth: '120px'\r\n    }\r\n  },\r\n  created () {\r\n    this.initTable()\r\n  },\r\n  methods: {\r\n    initTable (isSearch) {\r\n      this.loading = true\r\n      if (isSearch) {\r\n        this.pagination.page = 1\r\n      }\r\n      const query = {\r\n        page: this.pagination.page,\r\n        pageSize: this.pagination.pageSize,\r\n        filter: this.searchValue,\r\n        sortBy: this.pagination.sortBy,\r\n        sort: this.pagination.sort\r\n      }\r\n      this.$doRequest(api.getRoleList(query), '获取角色列表', this.$showErrorType.none).then((res) => {\r\n        setTimeout(() => {\r\n          this.loading = false\r\n        }, 200)\r\n        this.tableData = res.result\r\n        this.pagination.totalCount = res.totalCount\r\n      }, (err) => {\r\n        if (err) {\r\n          console.log(err)\r\n        }\r\n        setTimeout(() => {\r\n          this.loading = false\r\n        }, 200)\r\n      })\r\n    },\r\n    handleSizeChange (val) {\r\n      this.pagination.pageSize = val\r\n      this.initTable()\r\n    },\r\n    handleCurrentChange (val) {\r\n      this.pagination.page = val\r\n      this.initTable()\r\n    },\r\n    handleSortChange (val) {\r\n      this.pagination.sortBy = val.prop\r\n      if (val.order) {\r\n        this.pagination.sort = val.order === 'ascending' ? 'asc' : 'desc'\r\n      } else {\r\n        this.pagination.sort = null\r\n      }\r\n      this.initTable()\r\n    },\r\n    resetForm () {\r\n      this.form = {\r\n        name: '',\r\n        allows: []\r\n      }\r\n    },\r\n    removeResource (item) {\r\n      var index = this.form.allows.indexOf(item)\r\n      if (index !== -1) {\r\n        this.form.allows.splice(index, 1)\r\n      }\r\n    },\r\n    addResource () {\r\n      this.form.allows.push({\r\n        resources: '',\r\n        permissions: [],\r\n        key: this.$uuid()\r\n      })\r\n    },\r\n    handleCreate () {\r\n      this.resetForm()\r\n      this.dialogStatus = 'create'\r\n      this.dialogFormVisible = true\r\n      this.$nextTick(() => {\r\n        this.$refs['dataForm'].clearValidate()\r\n      })\r\n      this.$doRequest(api2.getResourceAll(), '获取资源列表', this.$showErrorType.none).then((res) => {\r\n        this.resourceOptions = []\r\n        res.result.forEach((item) => {\r\n          this.resourceOptions.push({\r\n            value: item.id,\r\n            label: item.name\r\n          })\r\n        })\r\n      })\r\n    },\r\n    createRole () {\r\n      this.$refs['dataForm'].validate((valid) => {\r\n        if (valid) {\r\n          const params = {\r\n            name: this.form.name,\r\n            allows: this.form.allows\r\n          }\r\n          this.$doRequest(api.addRole(params), '增加角色').then(() => {\r\n            this.initTable()\r\n            this.dialogFormVisible = false\r\n          })\r\n        }\r\n      })\r\n    },\r\n    handleEdit (id) {\r\n      this.$doRequest(api.getRole(id), '获取指定角色', this.$showErrorType.none).then((res) => {\r\n        let allows = []\r\n        for (let allow in res.allows) {\r\n          allows.push({\r\n            resources: allow,\r\n            permissions: res.allows[allow],\r\n            key: this.$uuid()\r\n          })\r\n        }\r\n        res.allows = allows\r\n        this.form = res || {}\r\n        this.dialogStatus = 'edit'\r\n        this.dialogFormVisible = true\r\n        this.$nextTick(() => {\r\n          this.$refs['dataForm'].clearValidate()\r\n        })\r\n        this.$doRequest(api2.getResourceAll(), '获取资源列表', this.$showErrorType.none).then((res) => {\r\n          this.resourceOptions = []\r\n          res.result.forEach((item) => {\r\n            this.resourceOptions.push({\r\n              value: item.id,\r\n              label: item.name\r\n            })\r\n          })\r\n        })\r\n      })\r\n    },\r\n    editRole () {\r\n      console.log('click')\r\n      this.$refs['dataForm'].validate((valid) => {\r\n        console.log('valid')\r\n        if (valid) {\r\n          const params = {\r\n            name: this.form.name,\r\n            allows: this.form.allows\r\n          }\r\n          this.$doRequest(api.editRole(this.form.id, params), '编辑角色').then(() => {\r\n            this.initTable()\r\n            this.dialogFormVisible = false\r\n          })\r\n        }\r\n      })\r\n    },\r\n    handleDelete (id, row) {\r\n      console.log('delete', id, row)\r\n      api.deleteRole(id).then(() => {\r\n        this.initTable()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style>\r\n  .demo-dynamic .el-input {\r\n    /*margin-right: 10px;*/\r\n    /*width: 270px;*/\r\n    /*vertical-align: top;*/\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/role/role.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container calendar-list-container\"},[_c('div',{staticClass:\"filter-container\"},[_c('el-button',{staticClass:\"filter-item\",attrs:{\"type\":\"primary\",\"icon\":\"el-icon-edit\"},on:{\"click\":_vm.handleCreate}},[_vm._v(_vm._s(_vm.$t('common.add')))]),_vm._v(\" \"),_c('el-input',{model:{value:(_vm.searchValue),callback:function ($$v) {_vm.searchValue=$$v},expression:\"searchValue\"}}),_vm._v(\" \"),_c('el-button',{staticClass:\"filter-item\",attrs:{\"type\":\"promary\"},on:{\"click\":_vm.initTable}},[_vm._v(\"搜索\")])],1),_vm._v(\" \"),_c('el-dialog',{attrs:{\"title\":_vm.$t('common.add') + _vm.$t('common.space') + _vm.$t('role.role'),\"visible\":_vm.dialogFormVisible},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"dataForm\",staticClass:\"demo-dynamic\",attrs:{\"rules\":_vm.rules,\"model\":_vm.form,\"label-position\":\"left\",\"label-width\":\"120px\"}},[_c('el-form-item',{attrs:{\"label\":_vm.$t('role.name'),\"prop\":\"name\"}},[_c('el-input',{attrs:{\"auto-complete\":\"off\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_vm._v(\" \"),_vm._l((_vm.form.allows),function(resource,index){return _c('el-form-item',{key:resource.key,attrs:{\"label\":'资源' + index}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-form-item',{attrs:{\"prop\":'allows.' + index + '.resources',\"rules\":{\n              required: true, message: '资源不能为空', trigger: 'blur'\n            }}},[_c('el-select',{attrs:{\"placeholder\":\"选择资源\"},model:{value:(resource.resources),callback:function ($$v) {_vm.$set(resource, \"resources\", $$v)},expression:\"resource.resources\"}},_vm._l((_vm.resourceOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}))],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":1}},[_vm._v(\"\\n          -\\n        \")]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":8}},[_c('el-form-item',{attrs:{\"prop\":'allows.' + index + '.permissions',\"rules\":{\n              required: true, message: '操作不能为空', trigger: 'blur'\n            }}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"选择权限\"},model:{value:(resource.permissions),callback:function ($$v) {_vm.$set(resource, \"permissions\", $$v)},expression:\"resource.permissions\"}},_vm._l((_vm.operationOptions),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}))],1)],1),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":3}},[_vm._v(\"\\n          -\\n        \")]),_vm._v(\" \"),_c('el-col',{attrs:{\"span\":4}},[_c('el-form-item',[_c('el-button',{staticStyle:{\"float\":\"right\"},on:{\"click\":function($event){$event.preventDefault();_vm.removeResource(resource)}}},[_vm._v(\"删除\")])],1)],1)],1)}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{on:{\"click\":_vm.addResource}},[_vm._v(\"新增资源\")])],1)],2),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(_vm._s(_vm.$t('common.cancel')))]),_vm._v(\" \"),(_vm.dialogStatus==='create')?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.createRole}},[_vm._v(_vm._s(_vm.$t('common.confirm')))]):_vm._e(),_vm._v(\" \"),(_vm.dialogStatus==='edit')?_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editRole}},[_vm._v(_vm._s(_vm.$t('common.confirm')))]):_vm._e()],1)],1),_vm._v(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData},on:{\"sort-change\":_vm.handleSortChange}},[_c('el-table-column',{attrs:{\"prop\":\"id\",\"label\":\"ID\",\"width\":\"180\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"name\",\"label\":_vm.$t('role.name'),\"sortable\":\"custom\",\"width\":\"180\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":_vm.$t('common.operation')},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\"},on:{\"click\":function($event){_vm.handleEdit(scope.row.id)}}},[_vm._v(_vm._s(_vm.$t('common.edit')))]),_vm._v(\" \"),_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){_vm.handleDelete(scope.row.id)}}},[_vm._v(_vm._s(_vm.$t('common.delete')))])]}}])})],1),_vm._v(\" \"),_c('el-pagination',{attrs:{\"current-page\":_vm.pagination.page,\"page-sizes\":[2, 5, 10, 20],\"page-size\":_vm.pagination.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.pagination.totalCount},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler?{\"id\":\"data-v-3f39bc62\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.2@vue-loader/lib/selector.js?type=template&index=0!./src/components/role/role.vue\n// module id = 9zTd\n// module chunks = 2","import axios from '@/services/axios'\r\n\r\n// 获取资源列表\r\nexport const getResourceList = (query) => axios.get(`/acl_resource?page=${query.page}&pageSize=${query.pageSize}&filter=${query.filter}&sortBy=${query.sortBy}&sort=${query.sort}`)\r\n\r\n// 获取所有资源\r\nexport const getResourceAll = () => axios.get(`/acl_resource`)\r\n\r\n// 添加资源\r\nexport const addResource = (params) => axios.post('./acl_resource', params)\r\n\r\n// 删除资源\r\nexport const deleteResource = (id) => axios.delete('./acl_resource/' + id)\r\n\r\n// 编辑资源\r\nexport const editResource = (id, params) => axios.put('./acl_resource/' + id, params)\r\n\r\n// 获取单个资源\r\nexport const getResource = (id) => axios.get('/acl_resource/' + id)\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/resource.js","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3f39bc62\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=styles&index=0!./role.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./role.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=script&index=0!./role.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3f39bc62\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.2@vue-loader/lib/selector?type=template&index=0!./role.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/role/role.vue\n// module id = V8iA\n// module chunks = 2"],"sourceRoot":""}